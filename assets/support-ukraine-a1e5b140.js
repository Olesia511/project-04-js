(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&c(r)}).observe(document,{childList:!0,subtree:!0});function n(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerpolicy&&(s.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?s.credentials="include":t.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function c(t){if(t.ep)return;t.ep=!0;const s=n(t);fetch(t.href,s)}})();const x="https://books-backend.p.goit.global/",me="books/category-list",ge="books/top-books",he="books/category",ye="books/";async function ke(){return await(await axios.get(`${x}${me}`)).data}async function be(){return await(await axios.get(`${x}${ge}`)).data}async function fe(e){return await(await axios.get(`${x}${he}?category=${e}`)).data}async function H(e){return await(await axios.get(`${x}${ye}${e}`)).data}let I="";const F=document.querySelector(".title-category");function D(e){I=e,fe(e).then(o=>{console.log("Get book by category",o),pe(o)}).catch(o=>console.log(o))}function pe(e){const o=document.querySelector(".list-books-by-category"),n=e.map(({book_image:t,title:s,author:r,_id:i})=>`<li data-book-id='${i}' class="element-books-by-category js-target">
      <div class="cover-wrap">
      <img src="${t}" alt="${s}" class="img-books-by-category js-target" />
       <p class="cover-text">quick view</p>
       </div>
      <div class="title-container js-target">
      <h3 class="name-books-by-category js-target">${s}</h3>
      <p class="title-books-by-category js-target">${r}</p>
      </div>
      </li>`).join("");return o.innerHTML=n,F.textContent=I,Le(F,I),document.querySelectorAll(".name-books-by-category").forEach(t=>{Se()}),ve(),n}function Le(e,o){const n=o.split(" "),c=n[n.length-1];let t="";n.forEach(s=>{t!==""&&(t+=" "),s===c?t+=`<span class="title-category-part">${s}</span>`:t+=s}),e.innerHTML=t}function Se(){const e=window.innerWidth;let o;e<768?o=31:o=19,document.querySelectorAll(".name-books-by-category").forEach(c=>{let t=c.textContent;if(t.length>o){const s=t.split(" ");let r="";for(const i of s)if(r.length+i.length<=o)r+=(r===""?"":" ")+i;else break;c.textContent=r+(r.length<t.length?"...":"")}})}function ve(){const e=window.innerWidth;let o,n;e>=1440?(o=30,n=5):e>=768?(o=40,n=6):(o=50,n=8),document.querySelectorAll(".title-books-by-category").forEach(t=>{const s=t.textContent;let i=s.split(" ").slice(0,n).join(" ");s.slice(0,o),i.length>o&&(i=i.slice(0,o)),t.textContent=`${i.length>o?i+"...":i}`})}const we=document.querySelector(".container-best-books");async function z(){await be().then(e=>{const o=e.map(t=>{const{list_name:s,books:r}=t,i=r.map(({_id:B,author:C,book_image:ue,title:_})=>`
              <li data-book-id="${B}" class="book-item js-target">
                <div class="cover-wrap">
                  <img class="book-img js-target" data-src="${ue}" alt="${_}" loading="lazy"/>
                  <p class="cover-text">quick view</p>
                </div>
                <div class="title-author-container">
                  <h2 class="book-title js-target">${_}</h2>
                  <h3 class="author js-target">${C}</h3>
                </div>
              </li>`).join("");return`
            <div class="category-container">
              <h2 class="category-title">${s}</h2>
              <ul class="book-list">${i}</ul>
              <button data-category="${s}" class="see-more-btn">SEE MORE</button>
            </div>`}).join(""),n=`
        <h1 class="title">
          Best Sellers <span class="highlighted-text">Books</span>
        </h1>`;we.innerHTML=n+o,document.querySelectorAll(".book-img").forEach(t=>{t.setAttribute("src",t.getAttribute("data-src")),t.onload=()=>t.removeAttribute("data-src")})}).catch(e=>console.log("rej",e))}const v=document.querySelector(".categories-list"),J=document.querySelector(".container-books-by-category"),P=document.querySelector(".top-books-box"),A=document.querySelector('input[type="checkbox"]');let d=null;z();function Y(){P.style.display="none"}function N(){P.style.display="flex"}function K(){J.style.display="none"}function G(){J.style.display="block"}let $,f;ke().then(e=>{const o='<li class="list-categories-item">All categories</li>'+e.map(({list_name:c})=>`<li class="list-categories-item">${c}</li>`).join("");v.insertAdjacentHTML("beforeend",o),d=v.firstChild,U(),$=document.querySelectorAll(".list-categories-item"),console.log($),f=[...$],console.log(f),A.checked&&V()}).catch(e=>console.log("rej",e)).finally(()=>{});v.addEventListener("click",Ee);function Ee(e){if(e.target.textContent!==d){{if(e.target===e.currentTarget)return;if(e.target===v.firstChild)document.querySelector(".container-best-books")?(L(),N(),K(),g.addEventListener("click",h)):(L(),K(),z(),N(),g.addEventListener("click",h));else{L(),Y();const o=e.target.textContent;console.log(o),D(o),G(),g.removeEventListener("click",h)}}d=e.target,d.classList.add("active-list-item")}}function U(){d.classList.add("active-list-item")}function L(){d.classList.remove("active-list-item")}console.log(A);A.addEventListener("change",qe);function qe(e){e.target.checked?V():xe()}function xe(){f.map(e=>e.classList.remove("dark"))}function V(){f.map(e=>e.classList.add("dark"))}const g=document.querySelector(".container-best-books");console.log();g.addEventListener("click",h);function h(e){if(!e.target.classList.contains("see-more-btn"))return;const o=e.target.dataset.category;console.log(typeof o),L(),Y(),D(o),G(),d=f.find(({textContent:n})=>n===`${o}`),U(),g.removeEventListener("click",h)}const u={openBurgerBtn:document.querySelector(".burger-menu"),burger:document.querySelector(".mobile-menu-container"),themeSwitcher:document.querySelector('input[type="checkbox"]')};console.dir(u.themeSwitcher);const Q=document.querySelector("body"),X=document.querySelector(".header-container"),Z=document.querySelector(".icon-close-mobile"),w=document.querySelector(".icon-close-burger"),ee=document.querySelector(".modal"),te=document.querySelector(".icon-close-modal"),E=document.querySelector(".menu-burger-icon"),oe=document.querySelector(".basket-icon");document.querySelector(".shop-list-placeholder");document.querySelector(".site-nav");const p="theme";let W;const T=localStorage.getItem(p);T==null&&(W="light",localStorage.setItem(p,JSON.stringify(W)),u.themeSwitcher.checked=!1);T&&(localStorage.getItem(p)==="dark"?(u.themeSwitcher.checked=!0,se()):u.themeSwitcher.checked=!1);u.themeSwitcher.addEventListener("change",ne);function se(){Q.classList.add("dark"),X.classList.add("dark"),Z.classList.add("dark"),w.classList.add("dark"),E.classList.add("dark"),oe.classList.add("dark"),ee.classList.add("dark"),te.classList.add("dark")}function Be(){Q.classList.remove("dark"),X.classList.remove("dark"),Z.classList.remove("dark"),w.classList.remove("dark"),E.classList.remove("dark"),oe.classList.remove("dark"),ee.classList.remove("dark"),te.classList.remove("dark")}u.themeSwitcher.addEventListener("change",ne);function ne(e){e.target.checked?(localStorage.setItem(p,"dark"),se()):(localStorage.setItem(p,"light"),Be())}(()=>{const e=document.querySelector(".backdrop-header"),o=document.querySelector(".js-menu-container"),n=document.querySelector(".js-open-menu"),c=document.querySelectorAll(".js-close-menu"),t=document.querySelector(".mob-menu-close"),s=()=>{const r=n.getAttribute("aria-expanded")==="true"||!1;n.setAttribute("aria-expanded",!r),e.classList.toggle("is-hidden-mobile"),t.classList.toggle("is-hidden-burger"),E.classList.toggle("is-hidden-burger"),w.classList.toggle("is-hidden-burger");const i=r?"enableBodyScroll":"disableBodyScroll";bodyScrollLock[i](document.body)};n.addEventListener("click",s),c.forEach(r=>{r.addEventListener("click",s)}),window.matchMedia("(min-width: 768px)").addEventListener("change",r=>{r.matches&&(o.classList.remove("is-open"),e.classList.add("is-hidden-mobile"),E.classList.remove("is-hidden-burger"),w.classList.add("is-hidden-burger"),n.setAttribute("aria-expanded",!1),bodyScrollLock.enableBodyScroll(document.body))})})();const ce=document.body,j=document.querySelector(".js-backdrop"),Ce=document.querySelector(".close-btn-modal"),re=document.querySelector(".modal"),S=document.querySelector(".btn-add-local"),y=document.querySelector(".add-local"),k=document.querySelector(".remove-local"),b=document.querySelector(".text-box");document.querySelector(".icon-close-modal");const q="user-books";let l;localStorage.getItem(q)?l=JSON.parse(localStorage.getItem(q)):l=[];const ie=document.querySelector(".add-books-backend");j.addEventListener("click",$e);Ce.addEventListener("click",M);window.addEventListener("keydown",O);function M(){j.classList.add("is-hidden"),re.classList.add("is-hidden"),window.removeEventListener("keydown",O),ce.classList.remove("disasble-scroll")}function $e(e){e.currentTarget===e.target&&M()}function O(e){e.code==="Escape"&&M()}const Ie=document.querySelector(".list-books-by-category"),Te=document.querySelector(".container-best-books");Ie.addEventListener("click",le);Te.addEventListener("click",le);S.addEventListener("click",je);async function le(e){if(e.target.classList.contains("js-target"))j.classList.remove("is-hidden"),re.classList.remove("is-hidden"),window.addEventListener("keydown",O),ce.classList.add("disasble-scroll");else return;const o=e.target.dataset.bookId??e.target.closest("li").dataset.bookId;l.findIndex(c=>c._id===`${o}`)!==-1?(y.hidden=!0,k.hidden=!1,b.classList.remove("text-off")):(y.hidden=!1,k.hidden=!0,b.classList.add("text-off")),await H(o).then(c=>{let t=c.book_image,s=c.title,r=c.description,i=c.author,a=c._id,B=c.buy_links[0].url,C=c.buy_links[1].url;ie.innerHTML=Ae(t,s,r,i,a,B,C)}).catch(c=>console.log(c))}function Ae(e,o,n,c,t,s,r){return`
  <div class="backend-box" data-book="${t}">
  <div class="cover-modal">

  <img class="img-book" src="${e}" loading="lazy" alt="${o}" />

  </div>
  <div>
 <h2 class="title-book">${o}</h2>
 <h4 class="author-book">${c}</h4>
 <p class="descr-book">${n}</p>
 <ul class="modal-img-list">
        <li>
          <a href="${s}" target="_blank" rel="noopener noreferrer nofollow">
          <div class="img-modal-amazon hover-img">
          </div>
          </a>
        </li>
        <li>
          <a href="${r}" target="_blank" rel="noopener noreferrer nofollow">
          <div class="img-modal-bookshop hover-img">
          </div>
          </a>
        </li>
      </ul>
 </div>
 </div>
  `}async function je(e){const o=e.target.textContent,n="add to shopping list",c=ie.childNodes[1].dataset.book;if(o===n)y.hidden=!1,k.hidden=!0,b.classList.add("text-off"),S.blur(),await H(c).then(t=>l.push({...t})).catch(t=>console.log(t)),console.log(l),await localStorage.setItem(q,JSON.stringify(l)),y.hidden=!0,k.hidden=!1,b.classList.remove("text-off"),S.blur();else{const t=l.findIndex(s=>s._id===c);t!==-1&&(l.splice(t,1),await localStorage.setItem(q,JSON.stringify(l)),y.hidden=!1,k.hidden=!0,b.classList.add("text-off"),S.blur())}}const R=document.querySelector(".list"),ae=document.getElementById("toggleButton"),Me=ae.querySelector("svg use");let m=!0;function de(){R.innerHTML="";const e=m?0:3,o=m?6:9;charities.slice(e,o).forEach((n,c)=>{const t=document.createElement("li"),s=document.createElement("a");s.target="_blank",s.rel="noopener noreferrer nofollow";const r=document.createElement("span"),i=(e+c+1).toString().padStart(2,"0");r.textContent=i;const a=document.createElement("img");a.src=n.img,a.srcset=`${n.img}`,a.alt=n.title,a.classList.add("white-image"),s.href=n.url,r.classList.add("number"),s.appendChild(a),t.appendChild(r),t.appendChild(s),R.appendChild(t)}),m=!m,Me.setAttribute("href",m?"./img/icon.svg#icon-support-ukr-scroll-up":"./img/icon.svg#icon-support-ukr-scroll-down")}ae.addEventListener("click",de);de();
